"0",""
"0","rgl_add_axes <- function(x, y, z, axis.col = ""black"",#52.20 42.79  3.75"
"0","                xlab =  paste('PC 1 -',as.character(varianza.bl.2d[1]), '%'), "
"0","                ylab=paste('PC 2 -',as.character(varianza.bl.2d[2]), '%'), "
"0","                zlab=paste('PC 3 -',as.character(varianza.bl.2d[3]), '%'), "
"0","                "
"0","                "
"0","                show.plane = FALSE, "
"0","                show.bbox = TRUE, bbox.col = c(""white"",""black""))"
"0","  { "
"0","  "
"0","  lim <- function(x){c(-max(abs(x)), max(abs(x))) * 1.1}"
"0","  # Add axes"
"0","  xlim <- lim(x); ylim <- lim(y); zlim <- lim(z)"
"0","  rgl.lines(xlim, c(0, 0), c(0, 0), color = axis.col)"
"0","  rgl.lines(c(0, 0), ylim, c(0, 0), color = axis.col)"
"0","  rgl.lines(c(0, 0), c(0, 0), zlim, color = axis.col)"
"0","  "
"0","   # Add a point at the end of each axes to specify the direction"
"0","   axes <- rbind(c(xlim[2], 0, 0), c(0, ylim[2], 0), "
"0","                 c(0, 0, zlim[2]))"
"0","   rgl.points(axes, color = axis.col, size = 3)"
"0","  "
"0","  # Add axis labels"
"0","  rgl.texts(axes, text = c(xlab, ylab, zlab), color = axis.col,"
"0","             adj = c(0.5, -0.8), size = 2)"
"0","  "
"0","  # # Add plane"
"0","  # if(show.plane) "
"0","  #   xlim <- xlim/1.1; zlim <- zlim /1.1"
"0","  #   rgl.quads( x = rep(xlim, each = 2), y = c(0, 0, 0, 0),"
"0","  #            z = c(zlim[1], zlim[2], zlim[2], zlim[1]))"
"0","  "
"0","  # Add bounding box decoration"
"0","  if(show.bbox){"
"0","    rgl.bbox(color=c(bbox.col[1],bbox.col[2]), alpha = 0.5, "
"0","          emission=bbox.col[1], specular=bbox.col[1], shininess=5, "
"0","          xlen = 3, ylen = 3, zlen = 3) "
"0","  }"
"0","}"
"0",""
"0",""
"0","library(rgl)"
"2","Registered S3 method overwritten by 'htmlwidgets':
  method           from         
  print.htmlwidget tools:rstudio
"
"2","
Attaching package: ‘rgl’

"
"2","The following object is masked _by_ ‘.GlobalEnv’:

    r3dDefaults

"
"0","x  <- coord.bl.2d[,1]"
"0","y  <- coord.bl.2d[,2]"
"0","z  <- coord.bl.2d[,3]"
"0","# here i make new vectors from the first 3 principal components in order to use them in graphical functions"
"0",""
"0",""
"0",""
"0","rgl_init()"
"0","r3dDefaults$windowRect <- c(0,50, 1200, 1200)"
"0","rgl.spheres(x, y, z, r = 0.7, color =class)"
"0","rgl_add_axes(x, y, z, show.bbox = FALSE)"
"0","text3d(x,y+0.01,z, rownames(coord.bl), col=""black"", pos=3, cex = 0.07)"
"0","aspect3d(1,1,1)"
"0","# browseURL("
"0","#   paste(""file://"", writeWebGL(dir=file.path(tempdir(), ""webGL""), "
"0","#   width=800), sep="""")"
"0","#   )"
"0",""
"0",""
"0",""

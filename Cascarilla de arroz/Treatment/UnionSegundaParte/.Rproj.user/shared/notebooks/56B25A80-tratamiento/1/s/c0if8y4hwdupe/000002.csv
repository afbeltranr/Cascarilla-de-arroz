"0","rgl_init <- function(new.device = FALSE, bg = ""white"", width = 640) { "
"0","  if( new.device | rgl.cur() == 0 ) {"
"0","    rgl.open()"
"0","    par3d(windowRect = 50 + c( 0, 0, width, width ) )"
"0","    rgl.bg(color = bg )"
"0","  }"
"0","  rgl.clear(type = c(""shapes"", ""bboxdeco""))"
"0","  rgl.viewpoint(theta = 15, phi = 20, zoom = 0.7)"
"0","}"
"0","rgl_add_axes <- function(x, y, z, axis.col = ""black"",#52.20 42.79  3.75"
"0","                xlab =  paste('PC 1 -',as.character(varianza.bl[1]), '%'), "
"0","                ylab=paste('PC 2 -',as.character(varianza.bl[2]), '%'), "
"0","                zlab=paste('PC 3 -',as.character(varianza.bl[3]), '%'), "
"0","                "
"0","                "
"0","                show.plane = FALSE, "
"0","                show.bbox = TRUE, bbox.col = c(""white"",""black""))"
"0","  { "
"0","  "
"0","  lim <- function(x){c(-max(abs(x)), max(abs(x))) * 1.1}"
"0","  # Add axes"
"0","  xlim <- lim(x); ylim <- lim(y); zlim <- lim(z)"
"0","  rgl.lines(xlim, c(0, 0), c(0, 0), color = axis.col)"
"0","  rgl.lines(c(0, 0), ylim, c(0, 0), color = axis.col)"
"0","  rgl.lines(c(0, 0), c(0, 0), zlim, color = axis.col)"
"0","  "
"0","   # Add a point at the end of each axes to specify the direction"
"0","   axes <- rbind(c(xlim[2], 0, 0), c(0, ylim[2], 0), "
"0","                 c(0, 0, zlim[2]))"
"0","   rgl.points(axes, color = axis.col, size = 3)"
"0","  "
"0","  # Add axis labels"
"0","  rgl.texts(axes, text = c(xlab, ylab, zlab), color = axis.col,"
"0","             adj = c(0.5, -0.8), size = 2)"
"0","  "
"0","  # # Add plane"
"0","  # if(show.plane) "
"0","  #   xlim <- xlim/1.1; zlim <- zlim /1.1"
"0","  #   rgl.quads( x = rep(xlim, each = 2), y = c(0, 0, 0, 0),"
"0","  #            z = c(zlim[1], zlim[2], zlim[2], zlim[1]))"
"0","  "
"0","  # Add bounding box decoration"
"0","  if(show.bbox){"
"0","    rgl.bbox(color=c(bbox.col[1],bbox.col[2]), alpha = 0.5, "
"0","          emission=bbox.col[1], specular=bbox.col[1], shininess=5, "
"0","          xlen = 3, ylen = 3, zlen = 3) "
"0","  }"
"0","}"

for(i in 1:1869){
promedios[i,6] <- (espectros[i,16]+espectros[i,17])/2
}
for (i in 1:1869){
for (j in 7:14){
promedios[i,j] <- (espectros[i,(3*j)-2] + espectros[i,((3*j)-2)+1] + espectros[i,(((3*j)-2)+2)])/3
}
}
head(promedios)
for (i in 1:1869){
for (j in 1:5){
promedios[i,j] <- (espectros[i,(3*j)-2] + espectros[i,((3*j)-2)+1] + espectros[i,(((3*j)-2)+2)])/3
colnames(promedios[,j]) <- names[3*j]
}
}
for (i in 1:1869){
for (j in 1:5){
promedios[i,j] <- (espectros[i,(3*j)-2] + espectros[i,((3*j)-2)+1] + espectros[i,(((3*j)-2)+2)])/3
colnames(promedios[,j]) <- nombres[3*j]
}
}
for (i in 1:1869){
for (j in 1:5){
promedios[i,j] <- (espectros[i,(3*j)-2] + espectros[i,((3*j)-2)+1] + espectros[i,(((3*j)-2)+2)])/3
colnames(promedios[,j]) <- nombres.t[3*j]
}
}
str(colnames(promedios[,1]))
dim(colnames(promedios[,1]))
promedios <- as.data.frame(promedios)
dim(colnames(promedios[,1]))
for (i in 1:1869){
for (j in 1:5){
promedios[i,j] <- (espectros[i,(3*j)-2] + espectros[i,((3*j)-2)+1] + espectros[i,(((3*j)-2)+2)])/3
colnames(promedios[,j]) <- nombres.t[3*j]
}
}
View(promedios)
View(nombres.t)
names(promedios)
for (i in 1:1869){
for (j in 1:5){
promedios[i,j] <- (espectros[i,(3*j)-2] + espectros[i,((3*j)-2)+1] + espectros[i,(((3*j)-2)+2)])/3
names(promedios[,j]) <- nombres.t[3*j]
}
}
View(promedios)
for (i in 1:1869){
for (j in 1:5){
promedios[i,j] <- (espectros[i,(3*j)-2] + espectros[i,((3*j)-2)+1] + espectros[i,(((3*j)-2)+2)])/3
names(promedios[,j]) <- nombres.t[3*j]
}
}
str(promedios)
str(nombres.t)
for (i in 1:1869){
for (j in 1:5){
promedios[i,j] <- (espectros[i,(3*j)-2] + espectros[i,((3*j)-2)+1] + espectros[i,(((3*j)-2)+2)])/3
names(promedios[,j]) <- nombres.t[,3*j]
}
}
str(promedios)
View(promedios)
str(promedios)
library(tibble)
?rownames_to_column
str(promedios)
espectros <- read.table('espectros.txt')
nombres <- read.table('nombres.txt', sep = '\t')
wavenumber <- read.table('wavenumber.txt')
colnames(espectros) <- t(nombres)
str(nombres)
#Todos estan de a 3 menos el 16 y el 17, que son "@A Room T 4 min 1.CSV" "@A Room T 4 min 2.CSV"
promedios <- matrix(,ncol=14, nrow=1869)
promedios <- as.data.frame(promedios)
str(promedios)
for (i in 1:1869){
for (j in 1:5){
promedios[i,j] <- (espectros[i,(3*j)-2] + espectros[i,((3*j)-2)+1] + espectros[i,(((3*j)-2)+2)])/3
names(promedios[,j]) <- t(nombres)[,3*j]
}
}
View(promedios)
for (i in 1:1869){
for (j in 1:5){
promedios[i,j] <- (espectros[i,(3*j)-2] + espectros[i,((3*j)-2)+1] + espectros[i,(((3*j)-2)+2)])/3
nombres.prom1[j] <- t(nombres)[,3*j]
}
}
for (i in 1:1869){
for (j in 1:5){
promedios[i,j] <- (espectros[i,(3*j)-2] + espectros[i,((3*j)-2)+1] + espectros[i,(((3*j)-2)+2)])/3
nombres.prom1[j] <- t(nombres)[,3*j]
}
}
# Primer parte, antes del 16
nombres.prom1 <- vector('character', 5)
for (i in 1:1869){
for (j in 1:5){
promedios[i,j] <- (espectros[i,(3*j)-2] + espectros[i,((3*j)-2)+1] + espectros[i,(((3*j)-2)+2)])/3
nombres.prom1[j] <- t(nombres)[,3*j]
}
}
names(promedios)[1:5]
names(promedios)[1:5] <- nombres.prom1
names(promedios)[1:5]
str(7:24)
str(7:14)
nombres.prom3 <- vector('character', 14)
for (i in 1:1869){
for (j in 7:14){
promedios[i,j] <- (espectros[i,(3*j)-2] + espectros[i,((3*j)-2)+1] + espectros[i,(((3*j)-2)+2)])/3
nombres.prom3[j] <- t(nombres)[,3*j]
}
}
head(promedios)
names(promedios)[6] <- t(nombres)[17]
head(promedios)
names(promedios)[7:14] <- nombres.prom1[7:14]
head(promedios)
names(promedios)[7:14] <- nombres.prom1[7:14]
head(promedios)
names(promedios)[7:14] <- nombres.prom3[7:14]
head(promedios)
View(promedios)
for(i in 1:1869){
promedios[i,6] <- (espectros[i,16]+espectros[i,17])/2
}
promedios.t <- t(promedios)
View(promedios.t)
colnames(promedios.t) <- wavenumber
colnames(promedios.t) <- wavenumber[1,]
str(wavenumber)
colnames(promedios.t) <- wavenumber[,1]
?sub
sub('.CSV', '_', rownames(promedios.t))
sub('.CSV', '', rownames(promedios.t))
sub('#.CSV', '', rownames(promedios.t))
sub('|.CSV', '', rownames(promedios.t))
sub('\.CSV', '', rownames(promedios.t))
sub('.CSV', '', rownames(promedios.t))
for (i in 1:1869){
for (j in 7:14){
promedios[i,j] <- (espectros[i,(3*j)-2] + espectros[i,((3*j)-2)+1] + espectros[i,(((3*j)-2)+2)])/3
nombres.prom3[j] <- t(nombres)[,(3*j)-1]
}
}
names(promedios)[7:14] <- nombres.prom3[7:14]
head(promedios)
sub('.CSV', '', rownames(promedios.t))
for (i in 1:1869){
for (j in 7:14){
promedios[i,j] <- (espectros[i,(3*j)-2] + espectros[i,((3*j)-2)+1] + espectros[i,(((3*j)-2)+2)])/3
nombres.prom3[j] <- t(nombres)[,(3*j)-2]
}
}
names(promedios)[7:14] <- nombres.prom3[7:14]
sub('.CSV', '', rownames(promedios.t))
t(nombres)
t(nombres)
sub('.CSV', '', rownames(promedios.t))
espectros <- read.table('espectros.txt')
nombres <- read.table('nombres.txt', sep = '\t')
wavenumber <- read.table('wavenumber.txt')
colnames(espectros) <- t(nombres)
str(nombres)
#Todos estan de a 3 menos el 16 y el 17, que son "@A Room T 4 min 1.CSV" "@A Room T 4 min 2.CSV"
promedios <- matrix(,ncol=14, nrow=1869)
promedios <- as.data.frame(promedios)
str(promedios)
# Primer parte, antes del 16
# Primer parte, antes del 16
nombres.prom1 <- vector('character', 5)
nombres[15]
t(nombres)[15,]
t(nombres)[,15]
nombres.prom1 <- vector('character', 5)
for (i in 1:1869){
for (j in 1:5){
promedios[i,j] <- (espectros[i,(3*j)-2] + espectros[i,((3*j)-2)+1] + espectros[i,(((3*j)-2)+2)])/3
nombres.prom1[j] <- t(nombres)[,3*j]
}
}
names(promedios)[1:5] <- nombres.prom1
str(promedios)
# Segunda parte, el 16 y el 17
colnames(espectros[,c(16,17)])
for(i in 1:1869){
promedios[i,6] <- (espectros[i,16]+espectros[i,17])/2
}
names(promedios)[6] <- t(nombres)[17]
str(promedios)
colnames(espectros[,18:20])
for (i in 1:1869){
for (j in 7:14){
promedios[i,j] <- (espectros[i,(3*j)-3] + espectros[i,((3*j)-3)+1] + espectros[i,(((3*j)-2)+1)])/3
nombres.prom3[j] <- t(nombres)[,(3*j)-1]
}
}
nombres.prom3 <- vector('character', 14)
for (i in 1:1869){
for (j in 7:14){
promedios[i,j] <- (espectros[i,(3*j)-3] + espectros[i,((3*j)-3)+1] + espectros[i,(((3*j)-2)+1)])/3
nombres.prom3[j] <- t(nombres)[,(3*j)-1]
}
}
names(promedios)[7:14] <- nombres.prom3[7:14]
sub('.CSV', '', rownames(promedios.t))
names(promedios)[7:14] <- nombres.prom3[7:14]
head(promedios)
42/3
str(promedios)
#Todos estan de a 3 menos el 16 y el 17, que son "@A Room T 4 min 1.CSV" "@A Room T 4 min 2.CSV"
promedios <- matrix(,ncol=15, nrow=1869)
promedios <- as.data.frame(promedios)
str(promedios)
# Primer parte, antes del 16
nombres.prom1 <- vector('character', 5)
for (i in 1:1869){
for (j in 1:5){
promedios[i,j] <- (espectros[i,(3*j)-2] + espectros[i,((3*j)-2)+1] + espectros[i,(((3*j)-2)+2)])/3
nombres.prom1[j] <- t(nombres)[,3*j]
}
}
str(promedios)
names(promedios)[1:5] <- nombres.prom1
str(promedios)
# Segunda parte, el 16 y el 17
colnames(espectros[,c(16,17)])
colnames(espectros[,18:20])
for(i in 1:1869){
promedios[i,6] <- (espectros[i,16]+espectros[i,17])/2
}
r
names(promedios)[6] <- t(nombres)[17]
nombres.prom3 <- vector('character', 14)
for (i in 1:1869){
for (j in 7:14){
promedios[i,j] <- (espectros[i,(3*j)-3] + espectros[i,((3*j)-3)+1] + espectros[i,(((3*j)-2)+1)])/3
nombres.prom3[j] <- t(nombres)[,(3*j)-1]
}
}
names(promedios)[7:14] <- nombres.prom3[7:14]
head(promedios)
for (i in 1:1869){
for (j in 7:15){
promedios[i,j] <- (espectros[i,(3*j)-3] + espectros[i,((3*j)-3)+1] + espectros[i,(((3*j)-2)+1)])/3
nombres.prom3[j] <- t(nombres)[,(3*j)-1]
}
}
names(promedios)[7:14] <- nombres.prom3[7:14]
head(promedios)
t(nombres)[44]
nombres.prom3 <- vector('character', 15)
for (i in 1:1869){
for (j in 7:15){
promedios[i,j] <- (espectros[i,(3*j)-3] + espectros[i,((3*j)-3)+1] + espectros[i,(((3*j)-2)+1)])/3
nombres.prom3[j] <- t(nombres)[,(3*j)-1]
}
}
names(promedios)[7:14] <- nombres.prom3[7:14]
head(promedios)
names(promedios)[7:15] <- nombres.prom3[7:15]
head(promedios)
promedios.t <- t(promedios)
colnames(promedios.t) <- wavenumber[,1]
sub('.CSV', '', rownames(promedios.t))
rownames(promedios.t) <- sub('.CSV', '', rownames(promedios.t))
?write.csv
write.csv(promedios.t, 'promedios.csv')
library(mdatools)
install.packages("mdatools")
library(mdatools)
mdaplot(promedios.t)
View(promedios.t)
mdaplot(wavenumber,promedios.t)
mdaplot(promedios.t, type = 'l', cgroup = 15)
str(promedios.t)
promedios.t <- as.data.frame(promedios.t)
View(promedios.t)
mdaplot(promedios.t, type = 'l', cgroup = 15)
mdaplot(promedios.t, type = 'l')
mdaplot(promedios.t, type = 'l', cgroup = 1:15)
mdaplot(promedios.t, type = 'l', cgroup = 1:15, show.labels = TRUE)
snvSpec <- prep.snv(promedios.t)
mdaplot(snvSpec, type = 'l', cgroup = 1:54)
mdaplot(promedios.t, type = 'l', cgroup = 1:15)
snvSpec <- prep.snv(promedios.t)
mdaplot(snvSpec, type = 'l', cgroup = 1:15)
alsSpec <- prep.alsbasecorr(snvSpec, plambda = 3, p = 0.01)
mdaplot(alsSpec,  type = 'l', cgroup = 1:54)
mdaplot(alsSpec,  type = 'l', cgroup = 1:15)
mdaplot(promedios.t, type = 'l', cgroup = 1:15)
snvSpec <- prep.snv(promedios.t)
mdaplot(snvSpec, type = 'l', cgroup = 1:15)
alsSpec <- prep.alsbasecorr(snvSpec, plambda = 3, p = 0.01)
espectros <- read.table('espectros.txt') # Leemos las intensidades de los espectros
nombres <- read.table('nombres.txt', sep = '\t')  # Los nombres de las muestras
wavenumber <- read.table('wavenumber.txt') # Los nombres de las variables, los numeros de onda
colnames(espectros) <- t(nombres)
str(nombres)
str(nombres)
colnames(espectros) <- t(nombres)
colnames(espectros) <- t(nombres)
head(espectros)
promedios <- matrix(,ncol=15, nrow=1869)
promedios <- as.data.frame(promedios)
str(promedios)
promedios <- matrix(,ncol=15, nrow=1869, 'numeric')
promedios <- matrix(,ncol=15, nrow=1869)
promedios <- as.data.frame(promedios)
str(promedios)
nombres.prom1 <- vector('character', 5)
names(promedios)[1:5] <- nombres.prom1
names(promedios)[1:5] <- nombres.prom1
str(promedios)
for (i in 1:1869){
for (j in 1:5){
promedios[i,j] <- (espectros[i,(3*j)-2] + espectros[i,((3*j)-2)+1] + espectros[i,(((3*j)-2)+2)])/3
nombres.prom1[j] <- t(nombres)[,3*j]
}
}
names(promedios)[1:5] <- nombres.prom1
str(promedios)
colnames(espectros[,c(16,17)])
for(i in 1:1869){
promedios[i,6] <- (espectros[i,16]+espectros[i,17])/2
}
names(promedios)[6] <- t(nombres)[17]
names(promedios)[6] <- t(nombres)[17]
str(promedios)
str(7:15)
nombres.prom3 <- vector('character', 15)
for (i in 1:1869){
for (j in 7:15){
promedios[i,j] <- (espectros[i,(3*j)-3] + espectros[i,((3*j)-3)+1] + espectros[i,(((3*j)-3)+2)])/3
nombres.prom3[j] <- t(nombres)[,(3*j)-1]
}
}
names(promedios)[7:15] <- nombres.prom3[7:15]
str(promedios)
promedios.t <- t(promedios)
colnames(promedios.t) <- wavenumber[,1]
promedios.t <- t(promedios)
colnames(promedios.t) <- wavenumber[,1]
mdaplot(promedios.t, type = 'l', cgroup = 1:15) + scale_x_reverse()
?mdaplot
mdaplot(promedios.t, type = 'l', cgroup = 1:15, xlim = rev(c(min(wavenumber), max(wavenumber))))
View(wavenumber)
View(espectros)
mdaplot(promedios.t, type = 'l', cgroup = 1:15, xlim = rev(c(min(wavenumber), 2000)))
mdaplot(promedios.t, type = 'l', cgroup = 1:15, xlim = rev(c(300, 2000)))
mdaplot(promedios.t, type = 'l', cgroup = 1:15, xlim = rev(c(200, 2000)))
mdaplot(promedios.t, type = 'l', cgroup = 1:15, xlim = rev(c(100, 2000)))
mdaplot(promedios.t, type = 'l', cgroup = 1:15, xlim = rev(c(0, 2000)))
library(ggplot2)
for(i in 1:15){
plot(wavenumber,
promedios.t[i,]
)
}
for(i in 1:15){
plot(wavenumber,
promedios.t[i,]
)
}
for(i in 1:15){
plot(wavenumber,
promedios.t[i,]
)
}
for(i in 1:15){
plot(wavenumber,
promedios.t[i,]
)
}
str(wavenumber)
for(i in 1:15){
plot(wavenumber[,1],
promedios.t[i,]
)
}
for(i in 1:15){
plot(wavenumber[,1],
promedios.t[i,],
ylim = c(0,0.1),
xlim = c(4000,400),
type = 'l'.
col = 1:15
)
par(new=T)
}
for(i in 1:15){
plot(wavenumber[,1],
promedios.t[i,],
ylim = c(0,0.1),
xlim = c(4000,400),
type = 'l',
col = 1:15
)
par(new=T)
}
par(new = F)
for(i in 1:15){
plot(wavenumber[,1],
promedios.t[i,],
ylim = c(0,0.1),
xlim = c(4000,400),
type = 'l',
col = 1:15
)
par(new=T)
}
color <- 1:15
par(new = F)
for(i in 1:15){
plot(wavenumber[,1],
promedios.t[i,],
ylim = c(0,0.3),
xlim = c(4000,400),
type = 'l',
col = color[i]
)
par(new=T)
}
?expressioj
?expression
color <- 1:15
par(new = F)
for(i in 1:15){
plot(wavenumber[,1],
promedios.t[i,],
ylim = c(0,0.3),
xlim = c(4000,400),
type = 'l',
col = color[i],
ylab = 'Absorbancia u.a.',
xlab = 'numero de onda cm-1'
)
par(new=T)
}
color <- 1:15
par(new = F)
for(i in 1:15){
plot(wavenumber[,1],
promedios.t[i,],
ylim = c(0,0.3),
xlim = c(4000,400),
type = 'l',
col = color[i],
ylab = 'Absorbancia u.a.',
xlab = 'numero de onda cm-1'
)
par(new=T)
}
espectros <- read.table('espectros.txt') # Leemos las intensidades de los espectros
nombres <- read.table('nombres.txt', sep = '\t')  # Los nombres de las muestras
espectros <- read.table('espectros.txt') # Leemos las intensidades de los espectros
nombres <- read.table('nombres.txt', sep = '\t')  # Los nombres de las muestras
wavenumber <- read.table('wavenumber.txt') # Los nombres de las variables, los numeros de onda
espectros <- read.table('espectros.txt') # Leemos las intensidades de los espectros
nombres <- read.table('nombres.txt', sep = '\t')  # Los nombres de las muestras
wavenumber <- read.table('wavenumber.txt') # Los nombres de las variables, los numeros de onda
espectros <- read.table('espectros.txt') # Leemos las intensidades de los espectros
nombres <- read.table('nombres.txt', sep = '\t')  # Los nombres de las muestras
wavenumber <- read.table('wavenumber.txt') # Los nombres de las variables, los numeros de onda
colnames(espectros) <- t(nombres) # Se asignan los caracteres en el vector nombres a los nombres de las columnas
head(espectros)# Se imprimen los primeros elementos del data.frame
promedios <- matrix(,ncol=15, nrow=1869) # Creamos una matriz vacia , con 1869 filas para cada numero de onda y 15 columnas para cada muestra promediada
promedios <- as.data.frame(promedios) #Convertimos el objeto promedios de matriz a data.frame, para poder tener valores numericos y caracteres al mismo tiempo.
str(promedios)# Revisamos la estructura del objeto, que está vacío
nombres.prom1 <- vector('character', 5)
for (i in 1:1869){
for (j in 1:5){
promedios[i,j] <- (espectros[i,(3*j)-2] + espectros[i,((3*j)-2)+1] + espectros[i,(((3*j)-2)+2)])/3
nombres.prom1[j] <- t(nombres)[,3*j]
}
}
names(promedios)[1:5] <- nombres.prom1
str(promedios)
colnames(espectros[,c(16,17)])
for(i in 1:1869){
promedios[i,6] <- (espectros[i,16]+espectros[i,17])/2
}
names(promedios)[6] <- t(nombres)[17]
str(promedios)
nombres.prom3 <- vector('character', 15)
for (i in 1:1869){
for (j in 7:15){
promedios[i,j] <- (espectros[i,(3*j)-3] + espectros[i,((3*j)-3)+1] + espectros[i,(((3*j)-3)+2)])/3
nombres.prom3[j] <- t(nombres)[,(3*j)-1]
}
}
names(promedios)[7:15] <- nombres.prom3[7:15]
str(promedios)
promedios.t <- t(promedios)
colnames(promedios.t) <- wavenumber[,1]# Agregamos los nombres de las variables
color <- 1:15
par(new = F)
for(i in 1:15){
plot(wavenumber[,1],
promedios.t[i,],
ylim = c(0,0.3),
xlim = c(4000,400),
type = 'l',
col = color[i],
ylab = 'Absorbancia u.a.',
xlab = 'numero de onda cm-1'
)
par(new=T)
}
install.packages("ggstatsplot")

p = 3,
w = w2+1,
delta.wav=2)
rownames(sg) <- rownames(corregido2)
for(i in 1:length(rownames(sg))){
plot(as.numeric(colnames(sg)),
sg[i,],
xlab = 'wave number cm-1',
ylab = '2nd derivative of abs',
xlim = c(1700,400),
ylim = c(-1e-04,1e-04),
type = 'l',
col = class[i])
par(new = T)
}
library(prospectr)
w2 <- 40
sg <- matrix(ncol = ncol(corregido2)-w2, nrow= nrow(corregido2))
sg <- as.data.frame(sg)
sg<- savitzkyGolay(X = corregido2
,m = 2,
p = 3,
w = w2+1,
delta.wav=2)
rownames(sg) <- rownames(corregido2)
for(i in 1:length(rownames(sg))){
plot(as.numeric(colnames(sg)),
sg[i,],
xlab = 'wave number cm-1',
ylab = '2nd derivative of abs',
xlim = c(1700,400),
ylim = c(-1e-04,1e-04),
type = 'l',
col = 1)
par(new = T)
}
pca.bl.2d <- prcomp(sg, scale=T, center = T)
coord.bl.2d <- pca.bl.2d$x
plot(coord.bl[,1],
coord.bl[,2],
pch = 19,
xlab = paste('PC 1 -',as.character(varianza.bl[1]), '%'),
ylab = paste('PC 2 -',as.character(varianza.bl[2]), '%'),
col = 1
)
pca.bl.2d <- prcomp(sg, scale=T, center = T)
coord.bl.2d <- pca.bl.2d$x
plot(coord.bl.2d[,1],
coord.bl.2d[,2],
pch = 19,
xlab = paste('PC 1 -',as.character(varianza.bl[1]), '%'),
ylab = paste('PC 2 -',as.character(varianza.bl[2]), '%'),
col = 1
)
pca.bl.2d <- prcomp(sg, scale=T, center = T)
vp.bl.2d <- (pca.bl.2d$sdev)^2
varianza.bl.2d <- round(vp.bl.2d/sum(vp.bl.2d)*100, 2)
varianza.bl.2d
coord.bl.2d <- pca.bl.2d$x
plot(coord.bl.2d[,1],
coord.bl.2d[,2],
pch = 19,
xlab = paste('PC 1 -',as.character(varianza.bl[1]), '%'),
ylab = paste('PC 2 -',as.character(varianza.bl[2]), '%'),
col = 1
)
res.hk$cluster
pca.bl.2d <- prcomp(sg, scale=T, center = T)
vp.bl.2d <- (pca.bl.2d$sdev)^2
varianza.bl.2d <- round(vp.bl.2d/sum(vp.bl.2d)*100, 2)
varianza.bl.2d
coord.bl.2d <- pca.bl.2d$x
plot(coord.bl.2d[,1],
coord.bl.2d[,2],
pch = 19,
xlab = paste('PC 1 -',as.character(varianza.bl.2d[1]), '%'),
ylab = paste('PC 2 -',as.character(varianza.bl.2d[2]), '%'),
col = res.hk$cluster[i]
)
pca.bl.2d <- prcomp(sg, scale=T, center = T)
vp.bl.2d <- (pca.bl.2d$sdev)^2
varianza.bl.2d <- round(vp.bl.2d/sum(vp.bl.2d)*100, 2)
varianza.bl.2d
coord.bl.2d <- pca.bl.2d$x
plot(coord.bl.2d[,1],
coord.bl.2d[,2],
pch = 19,
xlab = paste('PC 1 -',as.character(varianza.bl.2d[1]), '%'),
ylab = paste('PC 2 -',as.character(varianza.bl.2d[2]), '%'),
col = res.hk$cluster
)
library(factoextra)
df.sg <- sg
res.hk.sg <-hkmeans(df.sg, 4)
names(res.hk.sg)
fviz_dend(res.hk.sg, cex = 0.6, palette = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE)
options(ggrepel.max.overlaps = Inf)
fviz_dend(res.hk, cex = 0.6, palette = "jco",
rect = TRUE, rect_border = "jco", rect_fill = TRUE)
pca.bl.2d <- prcomp(sg, scale=T, center = T)
vp.bl.2d <- (pca.bl.2d$sdev)^2
varianza.bl.2d <- round(vp.bl.2d/sum(vp.bl.2d)*100, 2)
varianza.bl.2d
coord.bl.2d <- pca.bl.2d$x
plot(coord.bl.2d[,1],
coord.bl.2d[,2],
pch = 19,
xlab = paste('PC 1 -',as.character(varianza.bl.2d[1]), '%'),
ylab = paste('PC 2 -',as.character(varianza.bl.2d[2]), '%'),
col = res.hk.sg$cluster
)
fviz_cluster(res.hk.sg,
palette = "jco",
repel = TRUE,
ggtheme = theme_minimal(),
labelsize = 5)
pca.bl.2d <- prcomp(sg, scale=T, center = T)
vp.bl.2d <- (pca.bl.2d$sdev)^2
varianza.bl.2d <- round(vp.bl.2d/sum(vp.bl.2d)*100, 2)
varianza.bl.2d
coord.bl.2d <- pca.bl.2d$x
plot(coord.bl.2d[,1],
coord.bl.2d[,2],
pch = 19,
xlab = paste('PC 1 -',as.character(varianza.bl.2d[1]), '%'),
ylab = paste('PC 2 -',as.character(varianza.bl.2d[2]), '%'),
col = res.hk.sg$cluster
)
abline(h = 0, v =  0, lty=2)
for(i in 1:71){
plot(colnames(data),
data[i,],
type = 'l',
ylim = c(0,0.35),
xlim =  c(1700, 400),
ylab = 'absorbance (a.u.)',
xlab = expression("Wave number (" ~ cm^-1 ~ ")" ))
par(new = T)
}
for(i in 1:71){
plot(colnames(data),
data[i,],
type = 'l',
ylim = c(0,0.35),
xlim =  c(1700, 400),
ylab = 'absorbance (a.u.)',
xlab = expression("Wave number (" ~ cm^-1 ~ ")" ))
par(new = T)
}
rect(seq(1100,1090,by=10))
for(i in 1:71){
plot(colnames(data),
data[i,],
type = 'l',
ylim = c(0,0.35),
xlim =  c(1700, 400),
ylab = 'absorbance (a.u.)',
xlab = expression("Wave number (" ~ cm^-1 ~ ")" ))
par(new = T)
}
rect(seq(1100,1090,by=1))
?rect
for(i in 1:71){
plot(colnames(data),
data[i,],
type = 'l',
ylim = c(0,0.35),
xlim =  c(1700, 400),
ylab = 'absorbance (a.u.)',
xlab = expression("Wave number (" ~ cm^-1 ~ ")" ))
par(new = T)
}
rect(1100,0,1090,1)
for(i in 1:71){
plot(colnames(data),
data[i,],
type = 'l',
ylim = c(0,0.35),
xlim =  c(1700, 400),
ylab = 'absorbance (a.u.)',
xlab = expression("Wave number (" ~ cm^-1 ~ ")" ))
par(new = T)
}
rect(1100,0,1090,1, col = 'slateblue', density= 0.5)
for(i in 1:71){
plot(colnames(data),
data[i,],
type = 'l',
ylim = c(0,0.35),
xlim =  c(1700, 400),
ylab = 'absorbance (a.u.)',
xlab = expression("Wave number (" ~ cm^-1 ~ ")" ))
par(new = T)
}
rect(1100,0,1090,1, col = 'slateblue')
for(i in 1:71){
plot(colnames(data),
data[i,],
type = 'l',
ylim = c(0,0.35),
xlim =  c(1700, 400),
ylab = 'absorbance (a.u.)',
xlab = expression("Wave number (" ~ cm^-1 ~ ")" ))
par(new = T)
}
rect(1100,0,1090,1, col = 'slateblue', alpha = 0.1)
for(i in 1:71){
plot(colnames(data),
data[i,],
type = 'l',
ylim = c(0,0.35),
xlim =  c(1700, 400),
ylab = 'absorbance (a.u.)',
xlab = expression("Wave number (" ~ cm^-1 ~ ")" ))
par(new = T)
}
rect(1100,0,1090,1, col = 'slateblue', density = 0.5)
?ggplot
for(i in 1:71){
plot(colnames(data),
data[i,],
type = 'l',
ylim = c(0,0.35),
xlim =  c(1700, 400),
ylab = 'absorbance (a.u.)',
xlab = expression("Wave number (" ~ cm^-1 ~ ")" ))
par(new = T)
}
rect(1100,0,1050,1, col = 'slateblue', density = 0.5)
for(i in 1:71){
plot(colnames(data),
data[i,],
type = 'l',
ylim = c(0,0.35),
xlim =  c(1700, 400),
ylab = 'absorbance (a.u.)',
xlab = expression("Wave number (" ~ cm^-1 ~ ")" ))
par(new = T)
}
rect(1100,0,1050,1, col = col= rgb(0,0,1.0,alpha=0.5), density = 0.5)
for(i in 1:71){
plot(colnames(data),
data[i,],
type = 'l',
ylim = c(0,0.35),
xlim =  c(1700, 400),
ylab = 'absorbance (a.u.)',
xlab = expression("Wave number (" ~ cm^-1 ~ ")" ))
par(new = T)
}
rect(1100,0,1050,1, col= rgb(0,0,1.0,alpha=0.5), density = 0.5)
for(i in 1:71){
plot(colnames(data),
data[i,],
type = 'l',
ylim = c(0,0.35),
xlim =  c(1700, 400),
ylab = 'absorbance (a.u.)',
xlab = expression("Wave number (" ~ cm^-1 ~ ")" ))
par(new = T)
}
rect(1100,0,1050,1, col= rgb(0,0,1.0,alpha=0.5))
rect(1100,0,1050,1, col= rgb(0,0,1.0,alpha=0.5), border = NA)
for(i in 1:71){
plot(colnames(data),
data[i,],
type = 'l',
ylim = c(0,0.35),
xlim =  c(1700, 400),
ylab = 'absorbance (a.u.)',
xlab = expression("Wave number (" ~ cm^-1 ~ ")" ))
par(new = T)
}
rect(1100,0,1050,1, col= rgb(0,0,1.0,alpha=0.5), border = NA)
for(i in 1:71){
plot(colnames(data),
data[i,],
type = 'l',
ylim = c(0,0.35),
xlim =  c(1700, 400),
ylab = 'absorbance (a.u.)',
xlab = expression("Wave number (" ~ cm^-1 ~ ")" ))
par(new = T)
}
rect(1050,0,950,1, col= rgb(0,0,1.0,alpha=0.5), border = NA)
for(i in 1:71){
plot(colnames(data),
data[i,],
type = 'l',
ylim = c(0,0.35),
xlim =  c(1700, 400),
ylab = 'absorbance (a.u.)',
xlab = expression("Wave number (" ~ cm^-1 ~ ")" ))
par(new = T)
}
rect(1050,0,950,1, col= rgb(0,247,255,alpha=0.5), border = NA)
for(i in 1:71){
plot(colnames(data),
data[i,],
type = 'l',
ylim = c(0,0.35),
xlim =  c(1700, 400),
ylab = 'absorbance (a.u.)',
xlab = expression("Wave number (" ~ cm^-1 ~ ")" ))
par(new = T)
}
rect(1050,0,950,1, col= rgb(0,0.96,1,alpha=0.5), border = NA)
for(i in 1:71){
plot(colnames(data),
data[i,],
type = 'l',
ylim = c(0,0.35),
xlim =  c(1700, 400),
ylab = 'absorbance (a.u.)',
xlab = expression("Wave number (" ~ cm^-1 ~ ")" ))
par(new = T)
}
rect(1050,0,100,1, col= rgb(0,0.96,1,alpha=0.5), border = NA)
for(i in 1:71){
plot(colnames(data),
data[i,],
type = 'l',
ylim = c(0,0.35),
xlim =  c(1700, 400),
ylab = 'absorbance (a.u.)',
xlab = expression("Wave number (" ~ cm^-1 ~ ")" ))
par(new = T)
}
rect(1050,0,1000,1, col= rgb(0,0.96,1,alpha=0.5), border = NA)
for(i in 1:71){
plot(colnames(data),
data[i,],
type = 'l',
ylim = c(0,0.35),
xlim =  c(1700, 400),
ylab = 'absorbance (a.u.)',
xlab = expression("Wave number (" ~ cm^-1 ~ ")" ))
par(new = T)
}
rect(1065,0,1025,1, col= rgb(0,0.96,1,alpha=0.5), border = NA)
for(i in 1:71){
plot(colnames(data),
data[i,],
type = 'l',
ylim = c(0,0.35),
xlim =  c(1700, 400),
ylab = 'absorbance (a.u.)',
xlab = expression("Wave number (" ~ cm^-1 ~ ")" ))
par(new = T)
}
rect(1065,0,1025,1, col= rgb(0,0.96,1,alpha=0.5), border = NA)
rect(477,0,457,1, col= rgb(0,0.96,1,alpha=0.5), border = NA)
for(i in 1:71){
plot(colnames(data),
data[i,],
type = 'l',
ylim = c(0,0.35),
xlim =  c(1700, 400),
ylab = 'absorbance (a.u.)',
xlab = expression("Wave number (" ~ cm^-1 ~ ")" ))
par(new = T)
}
rect(1065,0,1025,1, col= rgb(0,0.96,1,alpha=0.5), border = NA)
rect(457,0,447,1, col= rgb(0,0.96,1,alpha=0.5), border = NA)
for(i in 1:71){
plot(colnames(data),
data[i,],
type = 'l',
ylim = c(0,0.35),
xlim =  c(1700, 400),
ylab = 'absorbance (a.u.)',
xlab = expression("Wave number (" ~ cm^-1 ~ ")" ))
par(new = T)
}
rect(1065,0,1025,1, col= rgb(0,0.96,1,alpha=0.5), border = NA)
rect(457,0,447,1, col= rgb(0,0.96,1,alpha=0.5), border = NA)
rect(789,0,809,1, col= rgb(0,0.96,1,alpha=0.5), border = NA)
cols <- brewer.pal(3,'Set3')
library(RColorBrewer)
cols <- brewer.pal(3,'Set3')
cols
?rgb
for(i in 1:71){
plot(colnames(data),
data[i,],
type = 'l',
ylim = c(0,0.35),
xlim =  c(1700, 400),
ylab = 'absorbance (a.u.)',
xlab = expression("Wave number (" ~ cm^-1 ~ ")" ))
par(new = T)
}
rect(1065,0,1025,1, col= rgb(141,211,199,alpha=0.5), border = NA)
for(i in 1:71){
plot(colnames(data),
data[i,],
type = 'l',
ylim = c(0,0.35),
xlim =  c(1700, 400),
ylab = 'absorbance (a.u.)',
xlab = expression("Wave number (" ~ cm^-1 ~ ")" ))
par(new = T)
}
rect(1065,0,1025,1, col= rgb(141,211,199,alpha=0.5), border = NA, maxColorValue = 255)
for(i in 1:71){
plot(colnames(data),
data[i,],
type = 'l',
ylim = c(0,0.35),
xlim =  c(1700, 400),
ylab = 'absorbance (a.u.)',
xlab = expression("Wave number (" ~ cm^-1 ~ ")" ))
par(new = T)
}
rect(1065,0,1025,1, col= rgb(141,211,199,alpha=0.5), border = NA, max = 255)
for(i in 1:71){
plot(colnames(data),
data[i,],
type = 'l',
ylim = c(0,0.35),
xlim =  c(1700, 400),
ylab = 'absorbance (a.u.)',
xlab = expression("Wave number (" ~ cm^-1 ~ ")" ))
par(new = T)
}
rect(1065,0,1025,1, col= rgb(141,211,199,alpha=0.5, max = 255), border = NA)
rect(457,0,447,1, col= rgb(141,211,199,alpha=0.5, max = 255), border = NA)
rect(789,0,809,1, col= rgb(141,211,199,alpha=0.5, max = 255), border = NA)
for(i in 1:71){
plot(colnames(data),
data[i,],
type = 'l',
ylim = c(0,0.35),
xlim =  c(1700, 400),
ylab = 'absorbance (a.u.)',
xlab = expression("Wave number (" ~ cm^-1 ~ ")" ))
par(new = T)
}
rect(1065,0,1025,1, col= rgb(141,211,199,
alpha=0.5
# ,max = 255
), border = NA)
for(i in 1:71){
plot(colnames(data),
data[i,],
type = 'l',
ylim = c(0,0.35),
xlim =  c(1700, 400),
ylab = 'absorbance (a.u.)',
xlab = expression("Wave number (" ~ cm^-1 ~ ")" ))
par(new = T)
}
rect(1065,0,1025,1, col= rgb(141,211,199,
alpha=0.5
,max = 255
), border = NA)
rect(457,0,447,1, col= rgb(141,211,199,alpha=0.5, max = 255), border = NA)
rect(789,0,809,1, col= rgb(141,211,199,alpha=0.5, max = 255), border = NA)
for(i in 1:71){
plot(colnames(data),
data[i,],
type = 'l',
ylim = c(0,0.35),
xlim =  c(1700, 400),
ylab = 'absorbance (a.u.)',
xlab = expression("Wave number (" ~ cm^-1 ~ ")" ))
par(new = T)
}
rect(1065,0,1025,1, col= rgb(0.55,0.83,0.78,
alpha=0.5), border = NA)
rect(457,0,447,1, col= rgb(141,211,199,alpha=0.5, max = 255), border = NA)
rect(789,0,809,1, col= rgb(141,211,199,alpha=0.5, max = 255), border = NA)
for(i in 1:71){
plot(colnames(data),
data[i,],
type = 'l',
ylim = c(0,0.35),
xlim =  c(1700, 400),
ylab = 'absorbance (a.u.)',
xlab = expression("Wave number (" ~ cm^-1 ~ ")" ))
par(new = T)
}
rect(1065,0,1025,1, col= rgb(0.55,0.83,0.78,alpha=0.5), border = NA)
rect(457,0,447,1, col= rgb(0.55,0.83,0.78,alpha=0.5), border = NA)
rect(789,0,809,1, col= rgb(0.55,0.83,0.78,alpha=0.5), border = NA)
for(i in 1:71){
plot(colnames(data),
data[i,],
type = 'l',
ylim = c(0,0.35),
xlim =  c(1700, 400),
ylab = 'absorbance (a.u.)',
xlab = expression("Wave number (" ~ cm^-1 ~ ")" ))
par(new = T)
}
rect(1065,0,1025,1, col= rgb(0.55,0.83,0.78,alpha=0.5), border = NA)
rect(467,0,447,1, col= rgb(0.55,0.83,0.78,alpha=0.5), border = NA)
rect(789,0,809,1, col= rgb(0.55,0.83,0.78,alpha=0.5), border = NA)
for(i in 1:71){
plot(colnames(data),
data[i,],
type = 'l',
ylim = c(0,0.35),
xlim =  c(1700, 400),
ylab = 'absorbance (a.u.)',
xlab = expression("Wave number (" ~ cm^-1 ~ ")" ))
par(new = T)
}
rect(1065,0,1025,1, col= rgb(0.55,0.83,0.78,alpha=0.5), border = NA)
rect(465,0,445,1, col= rgb(0.55,0.83,0.78,alpha=0.5), border = NA)
rect(789,0,809,1, col= rgb(0.55,0.83,0.78,alpha=0.5), border = NA)
